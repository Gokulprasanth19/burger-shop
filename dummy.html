<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cricket Scoring App</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #121212;
      color: #eeeeee;
      min-height: 100vh;
      background: linear-gradient(135deg, #222, #333);
    }
    header {
      backdrop-filter: blur(8px);
      background: rgba(30, 30, 30, 0.7);
      padding: 1rem;
      text-align: center;
      font-size: 1.5rem;
      font-weight: bold;
      color: #fbc02d;
      letter-spacing: 2px;
      box-shadow: 0 0 5px #fbc02d;
    }
    nav {
      display: flex;
      justify-content: center;
      background: rgba(50, 50, 50, 0.6);
      backdrop-filter: blur(6px);
      box-shadow: 0 0 8px #444;
    }
    nav button {
      flex: 1;
      background: transparent;
      border: none;
      padding: 12px 0;
      color: #ddd;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.3s, color 0.3s;
      border-bottom: 3px solid transparent;
    }
    nav button.active, nav button:hover {
      color: #fbc02d;
      border-bottom: 3px solid #fbc02d;
      background: rgba(255 255 255 / 0.1);
    }
    main {
      flex: 1;
      padding: 1rem;
      overflow-y: auto;
      backdrop-filter: blur(8px);
      background: rgba(30,30,30,0.5);
      margin: 1rem;
      border-radius: 12px;
      box-shadow: 0 0 15px #fbc02d;
      min-height: 75vh;
    }
    section { display: none; }
    section.active { display: block; }
    form {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      color: #eee;
    }
    form label {
      flex-basis: 150px;
      font-weight: 600;
      color:#fbc02d;
    }
    form input, form select {
      flex-grow: 1;
      padding: 6px 10px;
      border-radius: 6px;
      border: none;
      outline: none;
      background: rgba(255 255 255 / 0.1);
      color: #eee;
    }
    form button {
      padding: 10px 20px;
      background: #fbc02d;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 700;
      color: #222;
      transition: background 0.3s;
      margin-top: 1rem;
    }
    form button:hover { background: #d4a409; }
    .scoreboard {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      gap: 1rem;
      font-size: 1.25rem;
      font-weight: 700;
    }
    .score-item {
      background: rgba(255 255 255 / 0.1);
      padding: 1rem 2rem;
      border-radius: 12px;
      min-width: 120px;
      text-align: center;
      user-select: none;
      box-shadow: 0 0 8px #fbc02d;
    }
    .ball-inputs {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 1rem;
    }
    .ball-inputs button {
      background: rgba(255 255 255 / 0.1);
      border: none;
      border-radius: 50%;
      width: 45px;
      height: 45px;
      font-size: 1rem;
      font-weight: bold;
      color: #fbc02d;
      cursor: pointer;
      box-shadow: 0 0 6px #fbc02d;
      transition: transform 0.2s;
      display: flex;
      justify-content: center;
      align-items: center;
      user-select: none;
    }
    .ball-inputs button:hover {
      transform: scale(1.2);
      background: rgba(251 192 45 / 0.2);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
      color: #eee;
    }
    thead {
      background: rgba(251 192 45 / 0.3);
      color: #222;
      font-weight: 700;
    }
    th, td {
      padding: 0.5rem 0.8rem;
      text-align: center;
      border-bottom: 1px solid rgba(255 255 255 / 0.15);
    }
    .summary-panel { margin-top: 1rem; overflow-x: auto; }
    .summary-table { width: 100%; border-collapse: collapse; color: #eee; }
    .summary-table th, .summary-table td {
      padding: 0.4rem 0.6rem;
      border: 1px solid rgba(255 255 255 / 0.1);
      text-align: center;
      white-space: nowrap;
    }
    .delivery-sequence span { margin: 0 2px; font-size: 1.2rem; line-height: 1; }
    .dot-icon   { color: #eee; }
    .six-icon   { color: #ff5722; font-weight: bold; }
    .four-icon  { color: #ffca28; font-weight: bold; }
    .wicket-icon{ color: #e53935; font-weight: bold; }
    .wd-icon    { color: #4caf50; font-weight: bold; }
    .nb-icon    { color: #009688; font-weight: bold; }
    .striker { background: #fbc02d; color: #222; border-radius: 50%; padding: 2px 8px; font-weight: 700; margin-left: 5px; }
    .match-timer {
      margin-top: 1rem;
      text-align: center;
      font-size: 1.2rem;
      font-weight: 700;
      color: #fbc02d;
    }
    .timer-controls button {
      margin: 0 0.5rem;
      padding: 5px 15px;
      font-weight: 700;
      border-radius: 6px;
      background: #fbc02d;
      border: none;
      color: #222;
      cursor: pointer;
      transition: background 0.3s;
    }
    .timer-controls button:hover { background: #d4a409; }
    .target-input {
      margin-top: 1rem;
      display: flex;
      gap: 1rem;
      align-items: center;
      flex-wrap: wrap;
    }
    .target-input input {
      padding: 6px 10px;
      border-radius: 6px;
      border: none;
      outline: none;
      background: rgba(255 255 255 / 0.1);
      color: #eee;
      width: 150px;
    }
    .required-runrate {
      font-weight: 700;
      font-size: 1.2rem;
      color: #ff5722;
    }
    .animate-bounce { animation: bounce 0.5s ease-in-out; }
    .animate-shake  { animation: shake 0.5s ease-in-out; }
    .animate-glow   { animation: glow 1s ease-in-out infinite alternate; }
    @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }
    @keyframes shake  { 0%, 100% { transform: translateX(0); } 20%, 80% { transform: translateX(-10px); } 40%, 60% { transform: translateX(10px); } }
    @keyframes glow   { from { box-shadow: 0 0 10px #fbc02d; }  to { box-shadow: 0 0 20px #ffea00; } }
    .admin-controls {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }
    .admin-controls button {
      padding: 8px 15px;
      font-weight: 700;
      border-radius: 8px;
      border: none;
      background: #fbc02d;
      color: #222;
      cursor: pointer;
      transition: background 0.3s;
    }
    .admin-controls button:hover { background: #d4a409; }
    @media(max-width: 768px) {
      nav { flex-direction: column; }
      nav button {
        flex: none; width: 100%;
        border-bottom: none;
        border-right: 3px solid transparent;
        text-align: left;
        padding-left: 1.5rem;
      }
      nav button.active, nav button:hover {
        border-right: 3px solid #fbc02d;
        border-bottom: none;
      }
      main { margin: 0.5rem; }
      .scoreboard { flex-direction: column; gap: 0.8rem; }
    }
  </style>
</head>
<body>
  <header>Cricket Scoring App</header>
  <nav id="tab-nav">
    <button class="active" data-tab="scoreboard">Scoreboard</button>
    <button data-tab="summary">Summary</button>
    <button data-tab="batsmen">Batsmen</button>
    <button data-tab="bowlers">Bowlers</button>
    <button data-tab="matchinfo">Match Info</button>
    <button data-tab="admin">Admin Panel</button>
  </nav>

  <main>
    <section id="scoreboard" class="active">
      <div class="scoreboard">
        <div class="score-item">Runs: <span id="total-runs">0</span></div>
        <div class="score-item">Wickets: <span id="total-wickets">0</span></div>
        <div class="score-item">Overs: <span id="total-overs">0.0</span></div>
        <div class="score-item">Run Rate: <span id="run-rate">0.00</span></div>
      </div>
      <div class="ball-inputs">
        <button data-ball="0">0</button>
        <button data-ball="1">1</button>
        <button data-ball="2">2</button>
        <button data-ball="3">3</button>
        <button data-ball="4">4</button>
        <button data-ball="6">6</button>
        <button data-ball="W">W</button>
        <button data-ball="WD">WD</button>
        <button data-ball="NB">NB</button>
        <button data-ball="DOT">.</button>
      </div>
      <div class="match-timer">
        <span id="timer-display">00:00</span>
        <div class="timer-controls">
          <button id="timer-start">Start</button>
          <button id="timer-pause">Pause</button>
          <button id="timer-reset">Reset</button>
        </div>
      </div>
    </section>

    <section id="summary">
      <div class="summary-panel">
        <table class="summary-table">
          <thead>
            <tr>
              <th>Over</th>
              <th>Bowler</th>
              <th>Runs</th>
              <th>Deliveries</th>
            </tr>
          </thead>
          <tbody id="summary-body">
            <!-- over summaries here -->
          </tbody>
        </table>
      </div>
    </section>

    <section id="batsmen">
      <table>
        <thead>
          <tr>
            <th>Batsman</th>
            <th>Runs</th>
            <th>Balls</th>
            <th>4s</th>
            <th>6s</th>
            <th>Strike Rate</th>
            <th>Striker</th>
          </tr>
        </thead>
        <tbody id="batsman-body">
          <!-- batsman rows here -->
        </tbody>
      </table>
    </section>

    <section id="bowlers">
      <table>
        <thead>
          <tr>
            <th>Bowler</th>
            <th>Overs</th>
            <th>Runs</th>
            <th>Wickets</th>
          </tr>
        </thead>
        <tbody id="bowler-body">
          <!-- bowler rows here -->
        </tbody>
      </table>
    </section>

    <section id="matchinfo">
      <form id="match-setup">
        <label for="match-name">Match Name:</label>
        <input type="text" id="match-name" required />

        <label for="team1-name">Team 1 Name:</label>
        <input type="text" id="team1-name" required />

        <label for="team2-name">Team 2 Name:</label>
        <input type="text" id="team2-name" required />

        <label for="overs">Overs:</label>
        <input type="number" id="overs" min="1" max="50" value="20" required />

        <label for="toss-result">Toss Result:</label>
        <select id="toss-result" required>
          <option value="">Select</option>
          <option value="team1">Team 1 Won Toss</option>
          <option value="team2">Team 2 Won Toss</option>
        </select>

        <button type="submit">Start Match</button>
      </form>

      <div class="target-input">
        <label for="target-run">Target Run (2nd Innings):</label>
        <input type="number" id="target-run" min="0" placeholder="Set target for 2nd Innings" />
        <span class="required-runrate" id="required-runrate">Required RR: N/A</span>
      </div>
    </section>

    <section id="admin">
      <div class="admin-panel">
        <div class="admin-controls">
          <button id="undo-ball">Undo Last Ball</button>
          <button id="delete-over">Delete Last Over</button>
          <button id="score-correct">Score Correction</button>
        </div>
      </div>
    </section>
  </main>

  <script>
    // Tab switching
    const tabs = document.querySelectorAll('nav button');
    const sections = document.querySelectorAll('main section');
    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        sections.forEach(s => s.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(tab.dataset.tab).classList.add('active');
      });
    });

    // Match Data
    const matchData = {
      matchName: '',
      team1: '',
      team2: '',
      overs: 20,
      tossWonBy: '',
      innings: 1,
      balls: 0,
      runs: 0,
      wickets: 0,
      deliveries: [], // array of balls {runs, extras, wicket, ballType}
      batsmen: [],
      bowlers: [],
      currentBatsmen: [null, null],
      currentBowler: null,
      target: null,
      timerInterval: null,
      timerStart: null,
      timerElapsed: 0
    };

    const form = document.getElementById('match-setup');
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      matchData.matchName = document.getElementById('match-name').value.trim();
      matchData.team1 = document.getElementById('team1-name').value.trim();
      matchData.team2 = document.getElementById('team2-name').value.trim();
      matchData.overs = parseInt(document.getElementById('overs').value, 10);
      matchData.tossWonBy = document.getElementById('toss-result').value;
      matchData.innings = 1;
      matchData.balls = 0;
      matchData.runs = 0;
      matchData.wickets = 0;
      matchData.deliveries = [];
      matchData.batsmen = [
        { name: 'Batsman 1', runs: 0, balls: 0, fours: 0, sixes: 0 },
        { name: 'Batsman 2', runs: 0, balls: 0, fours: 0, sixes: 0 }
      ];
      matchData.bowlers = [
        { name: 'Bowler 1', overs: 0, runs: 0, wickets: 0 }
        // Add more bowlers as needed or allow changing bowler for each over
      ];
      matchData.currentBatsmen = [matchData.batsmen[0], matchData.batsmen[1]];
      matchData.currentBowler = matchData.bowlers[0];
      matchData.target = null;
      document.getElementById('target-run').value = '';
      updateScoreboard();
      updateBatsmenTable();
      updateBowlersTable();
      updateSummaryTable();
      alert('Match started! You can now input balls');
    });

    // Update scoreboard display
    function updateScoreboard() {
      document.getElementById('total-runs').textContent = matchData.runs;
      document.getElementById('total-wickets').textContent = matchData.wickets;
      const oversFloat = Math.floor(matchData.balls / 6) + '.' + (matchData.balls % 6);
      document.getElementById('total-overs').textContent = oversFloat;
      const runRate = matchData.balls > 0 ? (matchData.runs / (matchData.balls / 6)) : 0;
      document.getElementById('run-rate').textContent = runRate.toFixed(2);
      updateRequiredRunRate();
      checkMatchEnd();
    }

    // Update batsman table
    function updateBatsmenTable() {
      const tbody = document.getElementById('batsman-body');
      tbody.innerHTML = '';
      matchData.batsmen.forEach((batsman, index) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${batsman.name}${matchData.currentBatsmen[0] === batsman ? '<span class="striker">*</span>' : ''}</td>
          <td>${batsman.runs}</td>
          <td>${batsman.balls}</td>
          <td>${batsman.fours}</td>
          <td>${batsman.sixes}</td>
          <td>${batsman.balls > 0 ? ((batsman.runs / batsman.balls) * 100).toFixed(2) : '0.00'}</td>
          <td>${matchData.currentBatsmen[0] === batsman ? 'Yes' : ''}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    // Update bowler table
    function updateBowlersTable() {
      const tbody = document.getElementById('bowler-body');
      tbody.innerHTML = '';
      matchData.bowlers.forEach(bowler => {
        const oversFailSafe = bowler.overs || 0;
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${bowler.name}</td>
          <td>${oversFailSafe.toFixed(1)}</td>
          <td>${bowler.runs}</td>
          <td>${bowler.wickets}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    // Update summary table
    function updateSummaryTable() {
      const tbody = document.getElementById('summary-body');
      tbody.innerHTML = '';
      matchData.deliveries.forEach((over, index) => {
        const tr = document.createElement('tr');
        const ballsHTML = over.deliveries.map(ball => {
          const icons = {
            '0': '<span class="dot-icon">⚪️</span>',
            '1': '1',
            '2': '2',
            '3': '3',
            '4': '<span class="four-icon animate-bounce">🔥4</span>',
            '6': '<span class="six-icon animate-bounce">🔥6</span>',
            'W': '<span class="wicket-icon animate-shake">🧨W</span>',
            'WD': '<span class="wd-icon">WD</span>',
            'NB': '<span class="nb-icon">NB</span>',
            'DOT': '<span class="dot-icon">⚪️</span>'
          };
          return icons[ball] || ball;
        }).join(' ');
        tr.innerHTML = `
          <td>${index + 1}</td>
          <td>${over.bowler}</td>
          <td>${over.runs}</td>
          <td>${ballsHTML}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    // Ball input handling
    document.querySelectorAll('.ball-inputs button').forEach(button => {
      button.addEventListener('click', () => {
        const ball = button.getAttribute('data-ball');
        handleBallInput(ball);
      });
    });

    function handleBallInput(ball) {
      if (!matchData.matchName) {
        alert('Please set up and start the match first');
        return;
      }
      if (ball === 'WD' || ball === 'NB') {
        matchData.runs += 1;
      } else if (ball === 'W') {
        matchData.wickets += 1;
        matchData.balls += 1;
      } else if (ball === 'DOT' || ball === '0') {
        matchData.balls += 1;
      } else {
        const runs = parseInt(ball, 10);
        if (!isNaN(runs)) {
          matchData.runs += runs;
          matchData.balls += 1;
        }
      }
      // Over summary logic
      let currentOverIndex = Math.floor(matchData.balls / 6);
      if (!matchData.deliveries[currentOverIndex]) {
        matchData.deliveries[currentOverIndex] = { bowler: matchData.currentBowler.name, runs: 0, deliveries: [] };
      }
      matchData.deliveries[currentOverIndex].runs += 1;
      matchData.deliveries[currentOverIndex].deliveries.push(ball);
      updateScoreboard();
      updateSummaryTable();
      // Animate feedback (add class to last score)
      if (ball === '4' || ball === '6') {
        document.querySelector('.score-item:nth-child(1)').classList.add('animate-bounce');
        setTimeout(() => {
          document.querySelector('.score-item:nth-child(1)').classList.remove('animate-bounce');
        }, 600);
      }
      if (ball === 'W') {
        document.querySelector('.score-item:nth-child(2)').classList.add('animate-shake');
        setTimeout(() => {
          document.querySelector('.score-item:nth-child(2)').classList.remove('animate-shake');
        }, 600);
      }
    }

    // Timer controls
    const timerDisplay = document.getElementById('timer-display');
    const startBtn = document.getElementById('timer-start');
    const pauseBtn = document.getElementById('timer-pause');
    const resetBtn = document.getElementById('timer-reset');

    startBtn.addEventListener('click', () => {
      if (!matchData.timerInterval) {
        matchData.timerStart = Date.now() - matchData.timerElapsed;
        matchData.timerInterval = setInterval(() => {
          matchData.timerElapsed = Date.now() - matchData.timerStart;
          const sec = Math.floor(matchData.timerElapsed / 1000) % 60;
          const min = Math.floor(matchData.timerElapsed / (1000 * 60));
          timerDisplay.textContent = `${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
        }, 200);
      }
    });
    pauseBtn.addEventListener('click', () => {
      clearInterval(matchData.timerInterval);
      matchData.timerInterval = null;
    });
    resetBtn.addEventListener('click', () => {
      clearInterval(matchData.timerInterval);
      matchData.timerInterval = null;
      matchData.timerElapsed = 0;
      timerDisplay.textContent = '00:00';
    });

    document.getElementById('target-run').addEventListener('input', (e) => {
      const target = parseInt(e.target.value, 10);
      if (!isNaN(target)) {
        matchData.target = target;
      } else {
        matchData.target = null;
      }
      updateRequiredRunRate();
    });

    function updateRequiredRunRate() {
      if (matchData.target === null) {
        document.getElementById('required-runrate').textContent = 'Required RR: N/A';
        return;
      }
      const runsLeft = matchData.target - matchData.runs;
      const ballsLeft = matchData.overs * 6 - matchData.balls;
      if (ballsLeft <= 0) {
        document.getElementById('required-runrate').textContent = 'Required RR: N/A';
        return;
      }
      const rr = (runsLeft / ballsLeft) * 6;
      document.getElementById('required-runrate').textContent = `Required RR: ${rr.toFixed(2)}`;
    }

    function checkMatchEnd() {
      if (matchData.target !== null && matchData.runs > matchData.target) {
        alert(matchData.runs > matchData.target ? `${matchData.runs} > ${matchData.target}: Team batting wins!` : 'Match ended');
      }
      if (matchData.wickets >= 10 || matchData.balls >= matchData.overs * 6) {
        alert('Innings ended');
      }
    }

    // Admin controls
    document.getElementById('undo-ball').addEventListener('click', () => {
      if (matchData.deliveries.length === 0) return alert('No deliveries to undo');
      let lastOver = matchData.deliveries[matchData.deliveries.length - 1];
      if (lastOver.deliveries.length === 0) return alert('No deliveries to undo');
      let lastBall = lastOver.deliveries.pop();
      matchData.balls = Math.max(0, matchData.balls - 1);
      if (lastBall === 'WD' || lastBall === 'NB') {
        matchData.runs = Math.max(0, matchData.runs - 1);
      } else if (lastBall === 'W') {
        matchData.wickets = Math.max(0, matchData.wickets - 1);
      } else {
        let runs = parseInt(lastBall, 10);
        if (!isNaN(runs)) {
          matchData.runs = Math.max(0, matchData.runs - runs);
        }
      }
      lastOver.runs = Math.max(0, lastOver.runs - 1);
      if (lastOver.deliveries.length === 0) {
        matchData.deliveries.pop();
      }
      updateScoreboard();
      updateSummaryTable();
    });

    document.getElementById('delete-over').addEventListener('click', () => {
      if (matchData.deliveries.length === 0) return alert('No overs to delete');
      let lastOver = matchData.deliveries.pop();
      matchData.runs = Math.max(0, matchData.runs - lastOver.runs);
      matchData.balls = Math.max(0, matchData.balls - lastOver.deliveries.length);
      matchData.wickets = 0; // For demo, resets wickets
      updateScoreboard();
      updateSummaryTable();
    });

    document.getElementById('score-correct').addEventListener('click', () => {
      const newRuns = prompt('Enter new total runs:', matchData.runs);
      if (newRuns !== null) {
        const nr = parseInt(newRuns, 10);
        if (!isNaN(nr) && nr >= 0) {
          matchData.runs = nr;
          updateScoreboard();
        } else {
          alert('Invalid input');
        }
      }
    });

  </script>
</body>
</html>
